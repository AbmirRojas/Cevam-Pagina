<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEVAM - Student Platform</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/styles/recursos.css">
    <% if (locals.user.id_rol === 2 || locals.user.id_rol === 1) { %>
        <link rel="stylesheet" href="/styles/profesores.css">
    <% } %>
     <% if (locals.user.id_rol === 1) { %>
        <link rel="stylesheet" href="/styles/admin.css">
    <% } %>
</head>
<body>
    <!-- Mazer Sidebar -->
    <aside class="mazer-sidebar">
        <div class="mazer-logo">
            <h2>CEVAM</h2>
        </div>
        
        <div class="mazer-menu">
            <div class="menu-title">Main Menu</div>
            
            <div class="menu-item">
                <a href="#" class="menu-link active" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
            </div>
            
            <div class="menu-item">
                <a href="#" class="menu-link" data-section="library">
                    <i class="fas fa-book"></i>
                    <span>Resources</span>
                </a>
            </div>
            
            <div class="menu-title">Communication</div>
            
            <div class="menu-item">
                <a href="#" class="menu-link" data-section="announcements">
                    <i class="fas fa-bullhorn"></i>
                    <span>Announcements</span>
                </a>
            </div>

            <!-- Teacher Administration Section -->
            <% if (locals.user.id_rol === 2) { %>
                <div class="menu-title">Teacher Administration</div>
                <div class="menu-item teacher-menu">
                    <a href="#" class="menu-link" data-section="content">
                        <i class="fas fa-plus-circle"></i>
                        <span>Add Module</span>
                        <span class="teacher-indicator">Teacher</span>
                    </a>
                </div>
            <% } %>

            <!-- Administration Section -->
            <% if (locals.user.id_rol === 1) { %>  
                <div class="menu-title">Users Management</div>
                
                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="users">
                        <i class="fas fa-users"></i>
                        <span>Users</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>

                <div class="menu-title">Creation</div>

                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="bookCreation">
                        <i class="fas fa-plus-circle"></i>
                        <span>Add Resource</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>

                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="content">
                        <i class="fas fa-plus-circle"></i>
                        <span>Add Module</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>

                <div class="menu-title">Content Management</div>
            
                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="books">
                        <i class="fas fa-book"></i>
                        <span>Manage Resources</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>
                
                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="modules">
                        <i class="fas fa-book-open"></i>
                        <span>Modules</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>
                
                <div class="menu-title">Announcements Management </div>
                
                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="notifications">
                        <i class="fas fa-bullhorn"></i>
                        <span>Announce</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>

                <div class="menu-item admin-menu">
                    <a href="#" class="menu-link" data-section="manageAnnouncements">
                        <i class="fas fa-edit"></i>
                        <span>Manage Announcements</span>
                        <span class="admin-indicator">Admin</span>
                    </a>
                </div>
                
            <% } %>
            
            <div class="menu-title">Settings</div>
            
            <div class="menu-item">
                <a href="#" class="menu-link" id="settingsLink" data-section="profile">
                    <i class="fas fa-user-cog"></i>
                    <span>My Profile</span>
                </a>
            </div>
            
            <div class="menu-item">
                <a href="#" class="menu-link" id="darkModeLink">
                    <i class="fas fa-moon"></i>
                    <span>Dark Mode</span>
                </a>
            </div>

            <form action="/logout" method="get">
                <div class="menu-item">
                    <a href="/logout" class="menu-link" id="logoutLink">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </div>
            </form>
        </div>
    </aside>

    <button class="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="cevam-header">
            <div class="logo-container">
                <div class="logo">CE</div>
                <div class="site-info">
                    <h1>DASHBOARD - <%= locals.role.toUpperCase() %></h1>
                    <p>Virtual Learning Center</p>
                </div>
            </div>
            <div class="user-info">
                <div class="user-profile">
                    <div class="avatar" id="userAvatar"><%= user.nombre.charAt(0); %></div>
                    <div class="user-name" id="userName"><%= user.nombre %> <%= user.apellido %></div>
                </div>
            </div>
        </div>

        <!-- Main Content - Dashboard Section -->
         <% if ( locals.user.id_rol === 3 || locals.user.id_rol === 2 ) { %>
            
            <div class="main-container" id="dashboardSection">
                <div class="section-title">
                    <h2><i class="fas fa-home me-2"></i> <%= locals.role.charAt(0).toUpperCase() + locals.role.slice(1) %> Dashboard</h2>
                </div>
                
                <div class="content-section">
                    <h3>Welcome to the CEVAM Platform</h3>
                    <p>This is your personal area where you can access all educational resources, manage your courses, and customize your learning experience.</p>
                    
                    <div class="row mt-4">
                        <div class="col-md-6 mb-4">
                            <div class="dashboard-card">
                                <i class="fas fa-book"></i>
                                <h4>Resources</h4>
                                <p>Access all educational resources organized by categories.</p>
                                <button class="btn btn-primary mt-2" data-section="library">Go to Resources</button>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="dashboard-card">
                                <i class="fas fa-bullhorn"></i>
                                <h4>Announcements</h4>
                                <p>Stay informed with the latest platform announcements.</p>
                                <button class="btn btn-primary mt-2" data-section="announcements">View Announcements</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        <% } %>

        <% if ( locals.user.id_rol === 1 ) { %>
            <div class="main-container" id="dashboardSection">
                <div class="section-title">
                    <h2><i class="fas fa-home me-2"></i> Admin Dashboard</h2>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon students">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div class="stat-info">
                            <h3><%= locals.students.length %></h3>
                            <p>Students</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon teachers">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div class="stat-info">
                            <h3><%= locals.teachers.length %></h3>
                            <p>teachers</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon courses">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-info">
                            <h3><%= locals.numModules %></h3>
                            <p>Active Modules</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon active">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-info">
                            <h3><%= locals.teachers.length + locals.students.length + locals.admins.length %></h3>
                            <p>Users</p>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6 mb-4">
                        <div class="dashboard-card">
                            <i class="fas fa-book"></i>
                            <h4>Resources</h4>
                            <p>Access all educational resources organized by categories.</p>
                            <button class="btn btn-primary mt-2" data-section="library">Go to Resources</button>
                        </div>
                    </div>

                    <div class="col-md-6 mb-4">
                        <div class="dashboard-card">
                            <i class="fas fa-bullhorn"></i>
                            <h4>Announcements</h4>
                            <p>Stay informed with the latest platform announcements.</p>
                            <button class="btn btn-primary mt-2" data-section="announcements">View Announcements</button>
                        </div>
                    </div>
                </div>
            </div>
        <% } %>
        

        <!-- Main Content - Resources Section -->
        <div class="main-container" id="librarySection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-book me-2"></i> CEVAM Resources</h2>
            </div>
            
            <div class="library-grid">
                <!-- Books 1-10 will be generated dynamically -->            
            </div>
            
            <!-- Modules View -->
            <div class="modules-view" id="modulesView">
                <div class="back-to-library" id="backToLibrary">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to library</span>
                </div>
                
                <h2 class="book-modules-title" id="bookModulesTitle">Book 1</h2>
                
                <div class="modules-grid" id="modulesGrid">
                    <!-- Modules will be loaded here dynamically -->
                </div>
            </div>
            
            <!-- Book Modules View -->
            <div class="book-modules-view" id="bookModulesView">
                <!-- Specific module content will be loaded here -->
            </div>
        </div>
        
        <!-- Main Content - Profile Section -->
        <div class="main-container" id="profileSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-user-cog me-2"></i> Profile Settings</h2>
            </div>
            
            <div class="content-section">
                <div class="profile-form">
                    <div class="form-group">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" class="form-control" id="username" value="<%= user.nombre + " " + user.apellido %>" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="email" value="<%= user.correo %>" readonly>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Announcements Section -->
        <div class="main-container" id="announcementsSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-bullhorn me-2"></i> CEVAM Announcements</h2>
            </div>
            
            <div class="content-section">
                <h3>New Registrations & Platform Updates</h3>
                <p>Stay informed about the latest news, registration periods, and important platform updates.</p>

                <div id="announcementsContainer">
                    <!--Announcements Will be generated here -->
                </div>
            </div>
        </div>

        <!-- Module Creation Section (Teacher Only) -->
        <form id="moduleCreationForm" action="/createModule" method="post">
            <div class="main-container" id="contentSection" style="display: none;">
                <div class="section-title">
                    <h2><i class="fas fa-plus-circle me-2"></i> Create New Module</h2>
                </div>
                
                <div id="alertContainer"></div>
                
                <div class="form-container">
                    <h3 class="form-title"><i class="fas fa-file-alt"></i> Module Details</h3>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="moduleTitle">Module Title </label>
                                <input name="title" type="text" id="moduleTitle" class="form-control" placeholder="Ex: Advanced Grammar - Verb Tenses">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="moduleBook">Associated Book </label>
                                <select name="book" id="moduleBook" class="form-control">
                                    <option value="">Select Level</option>
                                    <option value="1">Level 1: Beginners</option>
                                    <option value="2">Level 2: Advanced Beginners</option>
                                    <option value="3">Level 3: Low Intermediate</option>
                                    <option value="4">Level 4: Intermediate</option>
                                    <option value="5">Level 5: Intermediate Intermediate</option>
                                    <option value="6">Level 6: Advanced Intermediate</option>
                                    <option value="7">Level 7: Advanced Intermediate</option>
                                    <option value="8">Level 8: Advanced</option>
                                    <option value="9">Level 9: Advanced</option>
                                    <option value="10">Level 10: Advanced Integrated</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="moduleTitle">Embeded Video</label>
                                <input name="videoURL" type="text" id="videoURL" class="form-control" placeholder="Ex: https://www.youtube.com/">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="contentType">Content Type </label>
                                <select name="contentType" id="contentType" class="form-control">
                                    <option value="">Select Type of Content</option>
                                    <option value="1">Grammar</option>
                                    <option value="2">Listening</option>
                                    <option value="3">Speaking</option>
                                    <option value="4">Reading</option>
                                    <option value="5">Writing</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="moduleDescription">Module Description </label>
                        <textarea name="description" id="moduleDescription" class="form-control" placeholder="Describe the module and its learning objectives..." rows="3"></textarea>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="content">Content</div>
                        <div class="tab" data-tab="evaluations">Evaluations</div>
                        <div class="tab" data-tab="resources">Resources</div>
                    </div>
                    
                    <!-- Content Tab -->
                    <div class="tab-content active" id="contentTab">
                        <div class="form-group">
                            <label for="contentBody">Main Content </label>
                            <textarea name="content" id="contentBody" class="form-control" placeholder="Write detailed module content here..." rows="8"></textarea>
                        </div>
                    </div>
                    
                    <!-- Evaluations Tab -->
                    <div class="tab-content" id="evaluationsTab">
                        <div id="questionsContainer">
                            <!-- Aquí se insertarán las preguntas dinámicamente -->
                        </div>

                        <button type="button" class="btn btn-secondary" id="addQuestionBtn" style="margin-top: 10px;">
                            <i class="fas fa-plus"></i> Agregar Pregunta
                        </button>
                    </div>


                    <!-- External Resources Tab -->
                    <div class="tab-content" id="resourcesTab">
                        <div class="form-group">
                             <button class="btn btn-primary" type="button" id="agregarBtn">
                                <i class="fas fa-plus"></i> Add a New File</button>
                             <div id="contenedor">
                                <!-- Aqui se generan los inputs necesarios para los archivos-->
                             </div>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 30px;">
                        <button class="btn btn-primary" id="saveModuleBtn">
                            <i class="fas fa-save me-2"></i> Save Module
                        </button>
                        <button class="btn btn-secondary" id="resetFormBtn">
                            <i class="fas fa-redo me-2"></i> Clear Form
                        </button>
                    </div>
                
                </div>
            </div>
        </form>

        <!-- Admin Section -->

        <!-- Main Content - Users Section -->
        <div class="main-container" id="usersSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-users me-2"></i> Users Management</h2>
            </div>
            
            <div class="content-section">
                <div class="form-group" style="max-width: 400px; margin-bottom: 25px;">
                    <input type="text" id="searchUserInput" class="form-control" placeholder="Buscar usuarios... Ex: Carlos...">
                </div>
                
                <table class="user-table">
                    <thead>
                        <tr>
                            <th>id</th>
                            <th>Email</th>
                            <th>Name</th>
                            <th>Role</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersContainer">
                        <!--user data will be generated here-->
                    </tbody>
                </table>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                    <div>1-5 of <%= admins.length + students.length + teachers.length%></div>
                    <div style="display: flex; gap: 10px;">
                        <button id="usersPrevBtn" class="btn btn-secondary">Previous</button>
                        <button id="usersNextBtn" class="btn btn-primary">Next</button>
                    </div>
                </div>
            </div>
        </div>

        
        
        <!-- Main Content - Book Creation Section -->
        <form action="/createBook" method="post">
            <div class="main-container" id="bookCreationSection" style="display: none;">
                <div class="section-title">
                    <h2><i class="fas fa-plus-circle me-2"></i> Create a New Book</h2>
                </div>
                <div class="content-card">
                    <h3 class="form-title"><i class="fas fa-file-alt"></i> Book Details</h3>

                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="bookTitle">Book Title </label>
                                <input name="title" type="text" id="bookTitle" class="form-control" placeholder="Ex: Beginner Level">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="level">Level </label>
                                <select name="level" id="level" class="form-control">
                                    <option value="">Select Level</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="bookDescription">Book Description </label>
                                <input name="description" type="text" id="bookDescription" class="form-control" placeholder="Ex: Build your English foundation with...">
                            </div>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i> Save Book
                        </button>
                    </div>

                </div>
            </div>
        </form>

        <!-- Main Content - Book Section -->
        <div class="main-container" id="booksSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-book me-2"></i> Books Management</h2>
            </div>
            <div class="content-card">
                <h3>CEVAM Library - Current Books</h3>
                
                <div id="booksContainer">
                    <!--Books will be generated Here -->
                </div>
            </div>
        </div>
        
        <!-- Main Content - Modules Section -->
        <div class="main-container" id="modulesSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-book-open me-2"></i> Modules Management</h2>
            </div>

            <div class="form-group">
                <input type="text" id="moduleSearch" class="form-control" placeholder="Search Module...">
            </div>

            <div class="content-section">
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div id="modulesContainer">
                        <!--Modules wll be generated here-->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main Content - Notifications Section -->
        <div class="main-container" id="notificationsSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-bullhorn me-2"></i> Announcements Management</h2>
            </div>
            
            <div class="content-section">
                <form action="/announcements" method="post">
                    <div class="notification-form">
                        <h3><i class="fas fa-paper-plane me-2"></i> Make an announcement</h3>
                        
                        <div class="form-group">
                            <label for="notificationTitle" class="form-label">Title</label>
                            <input type="text" name="notificationTitle" id="notificationTitle" class="form-control" placeholder="Ej: Mantenimiento programado">
                        </div>
                        
                        <div class="form-group">
                            <label for="notificationMessage" class="form-label">Message</label>
                            <textarea name="notificationMessage" id="notificationMessage" class="form-control" rows="4" placeholder="Escribe el contenido de la notificación..."></textarea>
                        </div>
                        
                        <div class="form-group" style="margin-top: 30px;">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-paper-plane me-2"></i> Send
                            </button>
                        </div>
                    </div>
                </form>
                
                
                <h3 style="margin-bottom: 20px;"><i class="fas fa-history me-2"></i> Latest Announcements</h3>
                
                <div class="activity-card">

                    
                    <div id="notificationsContainer">
                        <!--Anouncements Will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        
        <!--Manage Announcements Section-->
        <div class="main-container" id="manageAnnouncementsSection" style="display: none;">
            <div class="section-title">
                <h2><i class="fas fa-edit me-2"></i> Manage Announcements</h2>
            </div>
            
            <div class="content-section">
                <div class="form-group" style="max-width: 400px; margin-bottom: 25px;">
                    <input type="text" id="searchAnnouncementInput" class="form-control" placeholder="Buscar anuncios... Ej: Mantenimiento...">
                </div>
                
                <div class="table-responsive">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Título</th>
                                <th>Autor</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="announcementsManageContainer">
                            <!--announcement data will be generated here-->
                        </tbody>
                    </table>
                </div>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                    <div id="announcementsPaginationInfo">Cargando...</div>
                    <div style="display: flex; gap: 10px;">
                        <button id="announcementsPrevBtn" class="btn btn-secondary">Previous</button>
                        <button id="announcementsNextBtn" class="btn btn-primary">Next</button>
                    </div>
                </div>
            </div>
        
        

    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>

    <script src="/scripts/recursos.js"></script>
</body>
</html>